<!DOCTYPE html>
<html lang=" en" class="antialiased"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Upload files to Azure File Share using PowerShell &amp; Microsoft Flow | Powers Hell</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Upload files to Azure File Share using PowerShell &amp; Microsoft Flow" />
<meta name="author" content="Ben" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I‚Äôm a big fan of using Start-Transcript in my application install wrappers as it provides a very neat and tidy way to capture the output" />
<meta property="og:description" content="I‚Äôm a big fan of using Start-Transcript in my application install wrappers as it provides a very neat and tidy way to capture the output" />
<link rel="canonical" href="https://powers-hell.com/2018/12/19/upload-files-to-azure-file-share-using-powershell-microsoft-flow/" />
<meta property="og:url" content="https://powers-hell.com/2018/12/19/upload-files-to-azure-file-share-using-powershell-microsoft-flow/" />
<meta property="og:site_name" content="Powers Hell" />
<meta property="og:image" content="https://powers-hell.com/assets/images/2018/12/kltIrPS.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-12-18T15:09:42+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://powers-hell.com/assets/images/2018/12/kltIrPS.png" />
<meta property="twitter:title" content="Upload files to Azure File Share using PowerShell &amp; Microsoft Flow" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Ben"},"description":"I‚Äôm a big fan of using Start-Transcript in my application install wrappers as it provides a very neat and tidy way to capture the output","image":"https://powers-hell.com/assets/images/2018/12/kltIrPS.png","url":"https://powers-hell.com/2018/12/19/upload-files-to-azure-file-share-using-powershell-microsoft-flow/","headline":"Upload files to Azure File Share using PowerShell &amp; Microsoft Flow","@type":"BlogPosting","dateModified":"2018-12-18T15:09:42+00:00","datePublished":"2018-12-18T15:09:42+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://powers-hell.com/2018/12/19/upload-files-to-azure-file-share-using-powershell-microsoft-flow/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/app.css">
    <link rel="stylesheet" href="/assets/css/prism-dracula.css">
    <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.8.2/dist/alpine.min.js" defer></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-SGKQTF5F0T"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SGKQTF5F0T');
</script>
</head><body><div class="page-container">
    <div class="">
        <nav x-data="{ open: false }" class="nav sticky drac-bg-blackBlack">
            <div class="max-w-7xl mx-auto sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-16 px-4 sm:px-0">
                    <div class="flex items-center">
                        <div class="flex-shrink-0 link-hover">
                            <h2 class="drac-heading drac-heading-xl"><a href="/">Powers Hell</a></h2>
                        </div>
                        <div class="hidden md:block flex-shrink-0">
                            <div class="ml-10 flex items-baseline space-x-4">
                                <div id="tagalign" class="drac-text drac-text-cyan drac-text-right drac-line-height">
                                    great/power/is/great/fun >
                                    <div class="cursor"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="hidden md:block flex-shrink-0">
                        <div class="block md:hidden">
    <div class="ml-3 items-center relative">
        <a href="/"
            class="drac-btn drac-bg-purple-transparent drac-btn-ghost drac-text-cyan hover:drac-text-white drac-btn-sm drac-m-sm">Home</a>
    </div>
    <div class="ml-3 items-center relative">
        <a href="/about"
            class="drac-btn drac-bg-purple-transparent drac-btn-ghost drac-text-cyan drac-btn-sm drac-m-sm">About</a>
    </div>
    <div class="ml-3 items-center relative">
        <a href="/archives"
            class="drac-btn drac-bg-purple-transparent drac-btn-ghost drac-text-cyan drac-btn-sm drac-m-sm">Archives</a>
    </div>
    <div class="ml-3 items-center relative">
        <a href="/categories"
            class="drac-btn drac-bg-purple-transparent drac-btn-ghost drac-text-cyan drac-btn-sm drac-m-sm">Categories</a>
    </div>
    <div class="ml-3 items-center relative">
        <a href="https://merch.powers-hell.com"
            class="drac-btn drac-bg-purple-transparent drac-btn-ghost drac-text-cyan drac-btn-sm drac-m-sm">Merch</a>
    </div>
</div>
<div class="hidden md:block">
    <a href="/"
    class="drac-btn drac-bg-purple-transparent drac-btn-ghost drac-text-cyan hover:drac-text-white drac-btn-sm drac-m-sm">Home</a>
<a href="/about"
    class="drac-btn drac-bg-purple-transparent drac-btn-ghost drac-text-cyan drac-btn-sm drac-m-sm">About</a>
<a href="https://merch.powers-hell.com"
    class="drac-btn drac-bg-purple-transparent drac-btn-ghost drac-text-cyan drac-btn-sm drac-m-sm">Merch</a>
</div>



                    </div>
                    <div class="mr-2 flex md:hidden">
                        <!-- Mobile menu button -->
                        <button type="button"
                            class="drac-btn drac-bg-purple-transparent drac-btn-ghost drac-text-cyan drac-btn-sm drac-m-sm items-center justify-center p-2"
                            aria-controls="mobile-menu" aria-expanded="false" @click="open = !open" ara-expanded="false"
                            x-bind-aria-expanded="open.toString()">
                            <span class="sr-only">Open main menu</span>
                            <svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none"
                                viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true" x-state:on="Menu open"
                                x-state:off="Menu closed" :class="{ 'hidden':open, 'block': !(open) }">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M4 6h16M4 12h16M4 18h16" />
                            </svg>

                            <svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none"
                                viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true" x-state:on="Menu open"
                                x-state:off="Menu closed" :class="{ 'block':open, 'hidden': !(open) }">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M6 18L18 6M6 6l12 12" />
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
            <div class="drac-bg-black md:hidden" x-show.transition="open">
                <div class="px-2 py-3 space-y-1 sm:px-3 items-center">
                    <div id="tagalign" class="ml-3 drac-text drac-text-cyan drac-line-height">
                        great/power/is/great/fun >
                        <div class="cursor"></div>
                    </div>
                    <div class="block md:hidden">
    <div class="ml-3 items-center relative">
        <a href="/"
            class="drac-btn drac-bg-purple-transparent drac-btn-ghost drac-text-cyan hover:drac-text-white drac-btn-sm drac-m-sm">Home</a>
    </div>
    <div class="ml-3 items-center relative">
        <a href="/about"
            class="drac-btn drac-bg-purple-transparent drac-btn-ghost drac-text-cyan drac-btn-sm drac-m-sm">About</a>
    </div>
    <div class="ml-3 items-center relative">
        <a href="/archives"
            class="drac-btn drac-bg-purple-transparent drac-btn-ghost drac-text-cyan drac-btn-sm drac-m-sm">Archives</a>
    </div>
    <div class="ml-3 items-center relative">
        <a href="/categories"
            class="drac-btn drac-bg-purple-transparent drac-btn-ghost drac-text-cyan drac-btn-sm drac-m-sm">Categories</a>
    </div>
    <div class="ml-3 items-center relative">
        <a href="https://merch.powers-hell.com"
            class="drac-btn drac-bg-purple-transparent drac-btn-ghost drac-text-cyan drac-btn-sm drac-m-sm">Merch</a>
    </div>
</div>
<div class="hidden md:block">
    <a href="/"
    class="drac-btn drac-bg-purple-transparent drac-btn-ghost drac-text-cyan hover:drac-text-white drac-btn-sm drac-m-sm">Home</a>
<a href="/about"
    class="drac-btn drac-bg-purple-transparent drac-btn-ghost drac-text-cyan drac-btn-sm drac-m-sm">About</a>
<a href="https://merch.powers-hell.com"
    class="drac-btn drac-bg-purple-transparent drac-btn-ghost drac-text-cyan drac-btn-sm drac-m-sm">Merch</a>
</div>



                </div>
            </div>
        </nav>
      <div class="drac-bg-blackBlack pb-6 md:pb-24 lg:pb-28 xl:pb-8">
        <header class="py-10"><div class="main-overlay max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    
    <h1
        class="drac-heading drac-heading-2xl drac-text-center drac-text-cyan">
        
        Upload files to Azure File Share using PowerShell & Microsoft Flow
        
    </h1>
    
</div></header>
      </div>
      <div>
        <svg class="wave" viewBox="0 0 1792 335" xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink">
        <path d="M 0 50 C 259 50 259 209 518 209 L 518 209 L 518 0 L 0 0 Z" stroke-width="0"></path>
        <path d="M 517 209 C 800 209 800 96 1083 96 L 1083 96 L 1083 0 L 517 0 Z" stroke-width="0"></path>
        <path d="M 1082 96 C 1437 96 1437 189 1792 189 L 1792 189 L 1792 0 L 1082 0 Z" stroke-width="0"></path>
        </svg>
      </div><main class="-mt-4 md:-mt-64 lg:-mt-72 xl:-mt-80 2xl:-mt-96 4xl:-mt-112">
  <div class="main-overlay max-w-5xl mx-auto pb-12 px-4 sm:px-6 lg:px-8">
    <div class=" break-normal md:break-word drac-bg-black rounded-lg shadow-2xl px-5 py-6 sm:px-6">
      <article class="markdown-body drac-text drac-line-height line-numbers">

        <p class="post-date drac-text drac-text-xs"><font class="drac-text-black-secondary">Published:</font><font class="drac-text-cyan"> 18 Dec 2018</font>
          <br/>
          <font class="drac-text-black-secondary">File under:</font>
<font class="drac-text drac-text-xs">
    <a href="/category/flow/">Flow</a>, <a href="/category/intune/">Intune</a>,  <a href="/category/powershell/">PowerShell</a></font>
</p>
        <p>I‚Äôm a big fan of using Start-Transcript in my application install wrappers as it provides a very neat and tidy way to capture the output of everything that happens during the installation process and as such, all of the applications I package end up storing log files locally and I passionately and repeatedly urge my support staff to view these log files to identify issues during deployment. However, not everyone has the ‚Äúread the log files then troubleshoot‚Äù mentality, so I find myself having the same conversation over and over‚Ä¶</p>

<blockquote>
  <p>‚ÄúThe application failed to install. What‚Äôs wrong?‚Äù
‚ÄúI‚Äôm not sure, what do the log files say?‚Äù
‚ÄúI haven‚Äôt checked them yet‚Ä¶‚Äù
‚Äú‚Ä¶‚Äù</p>
</blockquote>

<!--more-->

<p>What if we could cut out the expectation that all your support staff has the same unhealthy obsession with log files, and automatically send those log files back to a central location so that we ‚Äúlog nerds‚Äù can dive in and troubleshoot things ourselves?!
As it turns out, as always, there is quite a simple way to do this using nothing but PowerShell &amp; Flow.</p>

<p><strong>A quick word of warning before we dig in:</strong> This is not in by any means the most effective way to consolidate log files. The smartest thing you could do is to start creating your log files in a standardized way so that you can have set up custom Log Analytics within Azure - <a href="https://docs.microsoft.com/en-us/azure/azure-monitor/platform/data-sources-custom-logs">there‚Äôs plenty of reading material around doing this</a>, and if you are looking to start doing some serious deep diving into your custom logs, I highly recommend spending some time looking into this.</p>

<p>In saying that, sometimes you just need everything in one place to get a better understanding of what‚Äôs going on. That‚Äôs where this solution comes into play.</p>

<p>There are two key pieces to this solution:</p>

<ol>
  <li>A serverless HTTP endpoint (web service) to prepare the incoming log files (binaries) and send them to an Azure File Share</li>
  <li>A PowerShell function to ingest the log files as soon as they are created</li>
</ol>

<p>Let‚Äôs break each of them down.</p>

<h3 id="building-a-web-service-to-handle-binaries-with-flow">Building a web service to handle binaries with Flow</h3>

<p>Firstly, a huge thanks has to go out to <a href="https://twitter.com/johnnliu">John Liu</a> for his great <a href="http://johnliu.net/blog/2017/7/building-non-json-webservices-with-Flow">blog post</a> that helped me build out the web service. I recommended reading his Microsoft Flow posts as they really shed a lot of light on the advanced features/capabilities that are hidden under the hood.</p>

<p>Let‚Äôs start with a blank Flow - in <strong>My Flows</strong> select <strong>New</strong>, <strong>Create from blank</strong> and then <strong>Create from blank</strong> again.</p>

<p>We are now going to add a HTTP Request trigger - search for <strong>request</strong> and add the trigger that appears.
We will not be working with the JSON schema in this trigger (as you will see later) but for now, simply put in a placeholder schema shown in the image below and click <strong>New Step</strong> to continue.</p>

<p><a href="https://i2.wp.com/i.imgur.com/kLaAVF8.png?w=1170&#038;ssl=1" title="http request"><img src="https://i2.wp.com/i.imgur.com/kLaAVF8.png?w=1170&#038;ssl=1" alt="http request" /></a></p>

<p>Search for and add ‚ÄúCompose‚Äù - this is where the magic happens! This compose step is what will handle the binary payload - we will be sending the binary files as a <strong>Multipart / Form-Data</strong> format which doesn‚Äôt adhere to a JSON schema.
Select the Input field and then select Expression. In the Expression field, we are going to type the following:</p>

<p><code class="language-plaintext highlighter-rouge">base64ToBinary(triggerMultipartBody(0)['$content'])</code></p>

<p>The expression may seem complicated, but it‚Äôs really just grabbing the binary from the request body (sent as a base64 encoded string) and decoding it to a binary object.</p>

<p>I also wanted a way to handle the <em>metadata</em> of the log file - things like the client name or the hostname of the device that sent the file, primarily so I can store the log file in a specific location for easier retrieval.</p>

<p>Create a new step and search for and add <strong>Parse JSON</strong>.
Next, we need to define the JSON data it is going to receive - the easiest way to do that is to create sample JSON payload in PowerShell and paste it in as shown below.</p>

<pre><code class="language-PowerShell">$payload = [PSCustomObject]@{
    hostName    = "placeholder"
    clientName  = "placeholder"
    appName     = "placeholder"
    logFileName = "placeholder"
}
$payload | ConvertTo-Json | clip
</code></pre>

<p>The code shown above will copy the JSON object into your clipboard, so back on your Flow, select <strong>Use sample payload</strong> and paste in the JSON object to create the schema required.</p>

<p>Next, select <strong>content</strong> and as done earlier, select <strong>Expression</strong>. In the expression formula field, type the following</p>

<p><code class="language-plaintext highlighter-rouge">triggerFormDataValue('metadata')</code></p>

<p>Basically, we are looking for some form data with the name value ‚Äòmetadata‚Äô. I‚Äôll pick this back up in the PowerShell section.</p>

<p>Finally, we are now going to bundle all of the metadata and the binary file and send it off to our storage account.</p>

<p>Select <strong>New Step</strong> and search for / add <strong>Azure Create File</strong>. Once added, you will be asked to create a connection to your storage account.
Give the connection a name, paste in the storage account name and access key, then hit <strong>Create</strong></p>

<p>Select the folder path in your storage account. (you‚Äôve got a storage account and file container set up already, yeah????)</p>

<p><a href="https://i0.wp.com/i.imgur.com/bTLYIvG.png?w=1170&#038;ssl=1" title="folder path"><img src="https://i0.wp.com/i.imgur.com/bTLYIvG.png?w=1170&#038;ssl=1" alt="folder path" /></a></p>

<p>Give the file a name - This is where I‚Äôm using the metadata to create dynamic folder structures to store the logs where I want them.</p>

<p><a href="https://i1.wp.com/i.imgur.com/j5e2u2M.png?w=1170&#038;ssl=1" title="filename"><img src="https://i1.wp.com/i.imgur.com/j5e2u2M.png?w=1170&#038;ssl=1" alt="filename" /></a></p>

<p>Then just point the file content to the output of the <strong>Compose</strong> and we are done.</p>

<p><a href="https://i0.wp.com/i.imgur.com/kltIrPS.png?w=1170&#038;ssl=1" title="File content"><img src="https://i0.wp.com/i.imgur.com/kltIrPS.png?w=1170&#038;ssl=1" alt="File content" /></a></p>

<p>Make sure you hit save, then go back up to the first step (HTTP request) and copy the <strong>HTTP Post URL</strong>.</p>

<p>Now let‚Äôs get into the PowerShell fun!</p>

<h3 id="powershell-function-to-send-binaries-to-flow">PowerShell function to send binaries to Flow</h3>

<p>Alright - the script has completed successfully (or failed miserably..) and we now want to send the log file up to our storage account. The first thing we need to do is prepare the log file.</p>

<pre><code class="language-PowerShell">if (Test-Path $inputObject) {
  $fileBytes = [System.IO.File]::ReadAllBytes($inputObject)
  $fileEnc = [System.Text.Encoding]::GetEncoding('UTF-8').GetString($fileBytes)
}
</code></pre>

<p>Simple enough, stream the file into a variable and encode using some dotNet libraries.</p>

<p>Now, let‚Äôs build out the request Body - this took me way too long but only because I had no idea how to handle <strong>Multipart / Form-Data</strong> requests. Let my pain help you!</p>

<p>First, let‚Äôs define a boundary - this will be the literal boundary between all the <strong>parts</strong>. The boundary needs to be a unique value that is not used anywhere else in your request, so in this case, let‚Äôs use a GUID.</p>

<p><code class="language-plaintext highlighter-rouge">$boundary = [System.Guid]::NewGuid().ToString()</code></p>

<p>Next, we will build out the request body - in retrospect, it‚Äôs quite simple, it‚Äôs just:</p>

<ul>
  <li>Boundary</li>
  <li>Content-Disposition: - basic data on the name of the object you are sending through</li>
  <li>Content-Type: what sort of data are you sending through</li>
  <li>The Content in question</li>
  <li>Boundary</li>
</ul>

<p>For every additional <em>part</em> that you want to add, you simply add another block of Content-Disposition, Content-Type, Content, Boundary.</p>

<p>Here‚Äôs my working example - I‚Äôm forming two parts - the binary log file &amp; a JSON object containing the metadata I want to send through for naming purposes.</p>

<pre><code class="language-PowerShell">$lf = "`r`n"
$bodyLines = (
    "--$boundary",
    "Content-Disposition: form-data; name=`"$(split-path $inputObject -leaf)`"; filename=`"$(split-path $inputObject -leaf)`"",
    "Content-Type: application/octet-stream$lf",
    $fileEnc,
    "--$boundary",
    "Content-Disposition: form-data; name=`"MetaData`"",
    "Content-Type: application/json$lf",
    $jsonMetaData,
    "--$boundary--$lf"
) -join $lf
</code></pre>

<p>A few key things here:</p>

<p>The content type of the encoded log file is Application/Octet-Stream - don‚Äôt question it. That‚Äôs how we send the binaries.
In the <strong>Content-Disposition</strong> for the JSON object, I gave it the name ‚ÄúMetaData‚Äù. This needs to match what we defined as our search term in the Flow app. Feel free to change this, but just remember to update the Flow app to match!.</p>

<p>Finally, we are just going to package everything up and send it off to the Flow web service with an Invoke-WebRequest.</p>

<pre><code class="language-PowerShell">$req = Invoke-WebRequest -Uri $uri -Method Post -ContentType "multipart/form-data; boundary=`"$boundary`"" -Body $bodyLines
return $req
</code></pre>

<p>So now we have the basics of our function ‚Äì let‚Äôs set up the metadata and point a log file at the function and see what happens.</p>

<pre><code class="language-PowerShell">$logFile = "C:\bin\TeamsClient.log"
$metaData = [PSCustomObject]@{
    hostName    = $ENV:ComputerName
    clientName  = "Contoso"
    appName     = "Teams"
    logFileName = "$ENV:ComputerName`_$(Split-Path -Path $logFile -Leaf)"
}
Send-IntuneLogsToFlow -inputObject $logFile -metaData $metaData
</code></pre>

<p>Checking the Flow app to confirm everything passed‚Ä¶</p>

<p><a href="https://i2.wp.com/i.imgur.com/J5D88rv.png?w=1170&#038;ssl=1" title="check the flow app"><img src="https://i2.wp.com/i.imgur.com/J5D88rv.png?w=1170&#038;ssl=1" alt="check the flow app" /></a></p>

<p>And finally - let‚Äôs make sure the log file was stored in the storage account!</p>

<p><a href="https://i2.wp.com/i.imgur.com/SWYbx01.png?w=1170&#038;ssl=1" title="Success!"><img src="https://i2.wp.com/i.imgur.com/SWYbx01.png?w=1170&#038;ssl=1" alt="Success!" /></a></p>

<p>Now I can connect to the Azure File Share using SMB3.0 and review all logs as they come down from the client machines without having to ask support or the end user if they have checked the log files!
The best part of this solution is I can use the same Flow app for any client I work with because I am dynamically creating the folder structure thanks to the metadata.</p>

<p>Finally, I‚Äôve put the PowerShell function up on my <a href="https://github.com/tabs-not-spaces/CodeDump/tree/master/Send-IntuneLogsToFlow">GitHub</a> as well as below for review.</p>

<pre><code class="language-PowerShell">function Send-IntuneLogsToFlow {
    param (
        $inputObject,
        $metaData
    )
    $Uri = "https://azure.flow.url.com";
    try {
        $jsonMetaData = $metaData | ConvertTo-Json -Compress
        if (Test-Path $inputObject) {
            $fileBytes = [System.IO.File]::ReadAllBytes("$inputObject")
            $fileEnc = [System.Text.Encoding]::GetEncoding('UTF-8').GetString($fileBytes)
        }
        else {
            throw "Error accessing input object: $inputObject"
        }
        $boundary = [System.Guid]::NewGuid().ToString()
        $lf = "`r`n"
        $bodyLines = (
            "--$boundary",
            "Content-Disposition: form-data; name=`"$(split-path $inputObject -leaf)`"; filename=`"$(split-path $inputObject -leaf)`"",
            "Content-Type: application/octet-stream$lf",
            $fileEnc,
            "--$boundary",
            "Content-Disposition: form-data; name=`"MetaData`"",
            "Content-Type: application/json$lf",
            $jsonMetaData,
            "--$boundary--$lf"
        ) -join $lf
        $req = Invoke-WebRequest -Uri $uri -Method Post -ContentType "multipart/form-data; boundary=`"$boundary`"" -Body $bodyLines
        return $req
    }
    catch {
        Write-Warning $_.Exception.Message
    }
}
</code></pre>

      </article>
    </div>
  </div>
<div class="main-overlay max-w-5xl mx-auto pb-12 px-4 sm:px-6 lg:px-8 drac-text-white drac-text-center">
    <div class="drac-box drac-mb-sm">
        <hr class="drac-divider drac-border-cyan" />
    </div>
    <h3 class="drac">Related Posts</h3>
    <ul class="related">
        
        <li><a href="/2021/03/08/working-with-intune-settings-catalog-using-powershell-and-graph/"><span class="drac-text-cyan">&raquo;</span> Working with Intune Settings Catalog using PowerShell and Graph</a></li>
        
        <li><a href="/2021/01/19/publishing-powershell-scripts-to-intune-with-graph/"><span class="drac-text-cyan">&raquo;</span> Publishing PowerShell scripts to Intune with Graph</a></li>
        
        <li><a href="/2020/10/25/deploying-universal-print-printers-with-powershell-intune/"><span class="drac-text-cyan">&raquo;</span> Deploying Universal Print Printers With PowerShell & Intune</a></li>
        
        <li><a href="/2020/05/04/create-a-bootable-windows-10-autopilot-device-with-powershell/"><span class="drac-text-cyan">&raquo;</span> Create a bootable Windows 10 Autopilot device with PowerShell!</a></li>
        
        <li><a href="/2020/04/25/installing-printers-with-intune-powershell/"><span class="drac-text-cyan">&raquo;</span> Installing printers with Intune & PowerShell</a></li>
        
    </ul>
</div>

</main>
  </div><script src="/assets/js/app.js"></script>
<script src="/assets/js/prism.js"></script>
<script type="text/javascript" src="/assets/js/lightbox.js"></script>
<link rel="stylesheet" href="/assets/css/lightbox.css">
</div>
<div>
    <svg class="wave" viewBox="0 0 1792 95.1" xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink">
        <path
            d="M1792,95.1c0-27,0-54,0-80.9c-40.7-5.1-101.2-11-174.5-12.3c-185.3-3.3-260.9,26.8-411.8,42.6
c-297.5,31.2-285-56-548.1-16.1C536.2,46.6,452.1,77.6,335.5,43C294,30.7,251,10.8,179.2,3C104.9-5,42.2,4.5,0,14.1v80.9H1792z" />
    </svg>
    <footer class="main-overlay drac-bg-blackBlack flex flex-wrap items-center justify-between p-3 m-auto">
        <div class="container mx-auto flex flex-col flex-wrap items-center justify-between">
            <div class="flex mx-auto drac-text-white text-center">
                <span>
                    <p class="drac-text-purple-cyan">
                        Powers Hell ¬© 2021
                    </p>
                </span>
            </div>
            <div class="flex mx-auto drac-text-white text-center">
                <span>
                    <p>
                        made by
                        <a href="https://twitter.com/powers_hell" target="_blank" class="drac-text-yellow">
                            Ben
                        </a>
                        with
                        <a href="https://github.com/tabs-not-spaces/powers-hell-blog" target="_blank"
                            class="drac-text-yellow-pink">
                            code, coffee & beer
                        </a>
                        üçª
                    </p>
                </span>
            </div>
        </div>
    </footer>
</div></body>

</html>